<html>
  <head>
    <title>Pipotron</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-133664781-4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-133664781-4');
    </script>

  </head>
  <body>
    <div class="container">
      <h1>Pipotron</h1>
      <form class="form-inline">
        <div class="form-group mb-2">
          <select id="dict" class="form-control mr-sm-2">
            <option value="custom">** custom **</option>
            <option value="accords">accords</option>
            <option value="ascii-face">ascii-face</option>
            <option value="asv">asv</option>
            <option value="bingo-winner">bingo-winner</option>
            <option value="example">example</option>
            <option value="excuse-a-2-balles">excuse-a-2-balles</option>
            <option value="fuu">fuu</option>
            <option value="horoscope">horoscope</option>
            <option value="html">html (rendering)</option>
            <option value="html" data-content-type="text/plain">html (source)</option>
            <option value="laboralphy">laboralphy</option>
            <option value="image-svg">image-svg</option>
            <option value="insulte-mignone" selected="selected">insulte-mignone</option>
            <option value="marabout">marabout</option>
            <option value="moijaime">moijaime</option>
            <option value="pipotron.free.fr">pipotron.free.fr</option>
            <option value="prenom-compose">prénom composé</option>
            <option value="project-idea">project idea</option>
            <option value="reve">reve</option>
            <option value="roman-photo">roman photo</option>
          </select>
        </div>
        <input class="btn btn-primary mb-2 mx-sm-3" type="button" id="generate" value="generate" />
        <a id="source" href="https://github.com/moul/pipotron" class="btn btn-secondary mb-2" target="_blank">Source</a>
        <textarea class="form-control" rows="10" id="source">Loading...</textarea>
      </form>
      <div class="border embed-responsive embed-responsive-16by9 code">
        <iframe class="embed-responsive-item" id="output">Loading...</iframe>
      </div>
      <hr />
      <footer>
        <a href="https://github.com/moul/pipotron">Pipotron</a>, by <a href="https://manfred.life/">Manfred Touron</a>.
      </footer>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
     function generate() {
       var dict = $('#dict').val();
       var contentType = $('#dict :selected').data('content-type');
       var url = '/run?dict=' + dict;
       if (contentType != undefined) {
         url += "&content-type=" + contentType;
       }
       $('#output').attr('src', url);
       $('#source').attr('href', 'https://github.com/moul/pipotron/blob/master/dict/'+dict+'.yml');
       gtag('event', "generate", {
         'category': dict,
         'label': dict,
       });
     }

     $('#generate').click(generate);
     $('#dict').change(generate);
     $(document).ready(function() {
       var qs_dict = (new URL(location.href)).searchParams.get('dict');
       if (qs_dict !== undefined && qs_dict !== null && qs_dict.length > 0) {
         $('#dict').val(qs_dict);
       }
       generate();
     });
    </script>
  </body>
</html>
